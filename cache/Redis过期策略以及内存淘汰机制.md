#### Redis过期策略以及内存淘汰机制

> 如果你的Redis只能存10G数据，你写了12G，那么Redis会怎么淘汰那2G数据呢？

##### 过期键删除策略

我们都知道，删除键的目的，就是释放内存占用。那么，当一个键过期了，Redis什么时候去删除她呢？

##### 定时删除

1. 设置键的过期时间时，创建一个Timer，当过期时间到临时，立即删除键。
2. 这是内存友好型策略，一旦键过期，就会被删除，并释放所占用的内存，cpu不友好，当一批数量比较多的键过期时，正好遇上cpu紧张的时候，这时候需要的是cpu处理能力，而不是内存，显然cpu时间用在删除过期键上，会对服务器的响应时间和吞吐量造成影响。另外当前redis时间事件无法高效处理大量时间事件，所以定时删除并不是一种好的删除策略。

##### 惰性删除

1. 不管过期的键，在这种策略下，当键在键空间中被取出时，首先检查取出的键是否过期，若过期删除该键，否则，返回该键。
2. 很明显，惰性删除依赖过期键的被动访问，对于内存不友好，如果一些键长期没有被访问，会造成内存泄漏（垃圾数据占据内存）。我们知道，Redis是依赖内存的，所以惰性删除也不是一个好的策略。

##### 定期删除

由定时删除算法，定期的去检查一定的数据库，删除一定的过期键。

通过合理的删除操作执行的时长和频率，达到合理的删除过期键。